var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function l(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,s)}a((o=o.apply(e,n||[])).next())}))},n=this&&this.__generator||function(e,n){var t,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(l=0)),l;)try{if(t=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,o=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!(i=l.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){l.label=s[1];break}if(6===s[0]&&l.label<i[1]){l.label=i[1],i=s;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(s);break}i[2]&&l.ops.pop(),l.trys.pop();continue}s=n.call(e,l)}catch(e){s=[6,e],o=0}finally{t=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@libs/fetch"),o=function(){function o(){this.id="skynovels",this.name="SkyNovels",this.site="https://www.skynovels.net/",this.version="1.0.0",this.icon="src/es/skynovels/icon.png"}return o.prototype.popularNovels=function(o,i){return e(this,void 0,void 0,(function(){var e,o,i;return n(this,(function(n){switch(n.label){case 0:return[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),o=[],null===(i=e.novels)||void 0===i||i.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",i={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};o.push(i)})),[2,o]}}))}))},o.prototype.parseNovel=function(o){return e(this,void 0,void 0,(function(){var e,i,r,l,s,a,u,c,v,p;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[1],i="https://api.skynovels.net/api/novel/"+e+"/reading?&q",[4,(0,t.fetchApi)(i)];case 1:return[4,n.sent().json()];case 2:return r=n.sent(),l=null===(c=null==r?void 0:r.novel)||void 0===c?void 0:c[0],(s={path:o,name:(null==l?void 0:l.nvl_title)||"Untitled"}).cover="https://api.skynovels.net/api/get-image/"+(null==l?void 0:l.image)+"/novels/false",a=[],null===(v=null==l?void 0:l.genres)||void 0===v||v.forEach((function(e){return a.push(e.genre_name)})),s.genres=a.join(","),s.author=null==l?void 0:l.nvl_writer,s.summary=null==l?void 0:l.nvl_content,s.status=null==l?void 0:l.nvl_status,u=[],null===(p=null==l?void 0:l.volumes)||void 0===p||p.forEach((function(e){var n;null===(n=null==e?void 0:e.chapters)||void 0===n||n.forEach((function(e){var n={name:e.chp_index_title,releaseTime:new Date(e.createdAt).toDateString(),path:o+e.id+"/"+e.chp_name};u.push(n)}))})),s.chapters=u,[2,s]}}))}))},o.prototype.parseChapter=function(o){return e(this,void 0,void 0,(function(){var e,i,r,l,s;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[3],i="https://api.skynovels.net/api/novel-chapter/".concat(e),[4,(0,t.fetchApi)(i)];case 1:return[4,n.sent().json()];case 2:return r=n.sent(),l=null===(s=null==r?void 0:r.chapter)||void 0===s?void 0:s[0],[2,(null==l?void 0:l.chp_content)||"404"]}}))}))},o.prototype.searchNovels=function(o,i){return e(this,void 0,void 0,(function(){var e,i,r,l;return n(this,(function(n){switch(n.label){case 0:return o=o.toLowerCase(),[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),i=null===(l=null==e?void 0:e.novels)||void 0===l?void 0:l.filter((function(e){return e.nvl_title.toLowerCase().includes(o)})),r=[],null==i||i.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",o={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};r.push(o)})),[2,r]}}))}))},o}();exports.default=new o;