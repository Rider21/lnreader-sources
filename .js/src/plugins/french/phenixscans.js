var e=this&&this.__awaiter||function(e,a,t,l){return new(t||(t=Promise))((function(r,n){function i(e){try{o(l.next(e))}catch(e){n(e)}}function u(e){try{o(l.throw(e))}catch(e){n(e)}}function o(e){var a;e.done?r(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(i,u)}o((l=l.apply(e,a||[])).next())}))},a=this&&this.__generator||function(e,a){var t,l,r,n,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function u(u){return function(o){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;n&&(n=0,u[0]&&(i=0)),i;)try{if(t=1,l&&(r=2&u[0]?l.return:u[0]?l.throw||((r=l.return)&&r.call(l),0):l.next)&&!(r=r.call(l,u[1])).done)return r;switch(l=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,l=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){i.label=u[1];break}if(6===u[0]&&i.label<r[1]){i.label=r[1],r=u;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(u);break}r[2]&&i.ops.pop(),i.trys.pop();continue}u=a.call(e,i)}catch(e){u=[6,e],l=0}finally{t=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,o])}}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("cheerio"),l=require("@libs/fetch"),r=require("@libs/filterInputs"),n=require("@libs/defaultCover"),i=require("@libs/novelStatus"),u=require("dayjs"),o=function(){function o(){this.id="phenixscans",this.name="PhenixScans",this.icon="src/fr/phenixscans/icon.png",this.site="https://phenixscans.fr",this.version="1.0.0",this.filters={genre:{type:r.FilterTypes.CheckboxGroup,label:"Genre",value:[],options:[{label:"Action",value:"action"},{label:"Action Adventure Fantaisie Psychologique",value:"action-adventure-fantaisie-psychologique"},{label:"Action Arts martiaux Aventure Fantastique Surnaturel",value:"action-arts-martiaux-aventure-fantastique-surnaturel"},{label:"Action Aventure Fantastique",value:"action-aventure-fantastique"},{label:"Action Drame Shônen",value:"action-drame-shonen"},{label:"Adult",value:"adult"},{label:"Adventure",value:"adventure"},{label:"amitié",value:"amitie"},{label:"amour",value:"amour"},{label:"Art-martiaux",value:"art-martiaux"},{label:"Arts-martiaux",value:"arts-martiaux"},{label:"Aventure",value:"aventure"},{label:"Combat",value:"combat"},{label:"Comedie",value:"comedie"},{label:"Comedy",value:"comedy"},{label:"Demons",value:"demons"},{label:"Dragon",value:"dragon"},{label:"Drama",value:"drama"},{label:"Drame",value:"drame"},{label:"Ecchi",value:"ecchi"},{label:"Fantaisie",value:"fantaisie"},{label:"fantastique",value:"fantastique"},{label:"Fantasy",value:"fantasy"},{label:"Ghosts",value:"ghosts"},{label:"Harem",value:"harem"},{label:"Historical",value:"historical"},{label:"Historique",value:"historique"},{label:"Horreur",value:"horreur"},{label:"Horror",value:"horror"},{label:"Isekai",value:"isekai"},{label:"Josei",value:"josei"},{label:"longstrip art",value:"longstrip-art"},{label:"Magic",value:"magic"},{label:"Magie",value:"magie"},{label:"Male Protagonist",value:"male-protagonist"},{label:"manga",value:"manga"},{label:"Manhwa",value:"manhwa"},{label:"Manhwa Player",value:"manhwa-player"},{label:"Manwha",value:"manwha"},{label:"Martial Arts",value:"martial-arts"},{label:"Mature",value:"mature"},{label:"Monstre",value:"monstre"},{label:"Murim",value:"murim"},{label:"mystère",value:"mystere"},{label:"Mystery",value:"mystery"},{label:"Necromancien",value:"necromancien"},{label:"necromencer",value:"necromencer"},{label:"Novel",value:"novel"},{label:"One Shot",value:"one-shot"},{label:"Over Power MC",value:"over-power-mc"},{label:"Partenaire",value:"partenaire"},{label:"Player",value:"player"},{label:"Player Manhwa",value:"player-manhwa"},{label:"Portail",value:"portail"},{label:"Psychological",value:"psychological"},{label:"Psychologique",value:"psychologique"},{label:"regresseur",value:"regresseur"},{label:"régression",value:"regression"},{label:"Réincarnation",value:"reincarnation"},{label:"Returner",value:"returner"},{label:"Romance",value:"romance"},{label:"School Life",value:"school-life"},{label:"Sci-fi",value:"sci-fi"},{label:"Seinen",value:"seinen"},{label:"Shôjo",value:"shojo"},{label:"Shônen",value:"shonen"},{label:"Shotacon",value:"shotacon"},{label:"Shoujo",value:"shoujo"},{label:"Shounen",value:"shounen"},{label:"Slice of Life",value:"slice-of-life"},{label:"Slide of Life",value:"slide-of-life"},{label:"Smut",value:"smut"},{label:"Sports",value:"sports"},{label:"Supernatural",value:"supernatural"},{label:"Surnaturel",value:"surnaturel"},{label:"Système",value:"systeme"},{label:"Tragédie",value:"tragedie"},{label:"Tragedy",value:"tragedy"},{label:"Webtoons",value:"webtoons"}]}}}return o.prototype.getCheerio=function(r){return e(this,void 0,void 0,(function(){var e;return a(this,(function(a){switch(a.label){case 0:return[4,(0,l.fetchApi)(r)];case 1:return[4,a.sent().text()];case 2:return e=a.sent(),[2,(0,t.load)(e)]}}))}))},o.prototype.popularNovels=function(t,l){return e(this,arguments,void 0,(function(e,t){var l,r,i,u,o,s,c,v,h,b,p=this,m=t.showLatestNovels,f=t.filters;return a(this,(function(a){switch(a.label){case 0:for(u in l=[],i="",f)if("object"==typeof f[u].value)for(o=0,s=f[u].value;o<s.length;o++)c=s[o],i+="&genre%5B%5D=".concat(c);return v=m?"update":"popular",h="".concat(this.site,"/manga/?page=").concat(e).concat(i,"&status=&type=novel&order=").concat(v),[4,this.getCheerio(h)];case 1:return(b=a.sent())("div div div div a").each((function(e,a){var t,i=null===(t=b(a).attr("title"))||void 0===t?void 0:t.trim(),u=b(a).attr("href"),o=b(a).find("div img").attr("src")||n.defaultCover;u&&i&&(r={name:i,cover:o,path:u.replace(p.site,"")},l.push(r))})),[2,l]}}))}))},o.prototype.parseNovel=function(t){return e(this,void 0,void 0,(function(){var e,l,r,i=this;return a(this,(function(a){switch(a.label){case 0:return e={path:t,name:"Sans titre"},[4,this.getCheerio(this.site+t)];case 1:return l=a.sent(),e.name=l("h1[itemprop=name]").text().replace("– Novel","").trim(),e.cover=l("div[itemprop=image] img").first().attr("src")||n.defaultCover,e.author=l(".fmed b:contains(Auteur)+span").text().trim(),e.genres=l(".mgen a").map((function(){return l(this).text()})).get().join(", "),e.summary=l(".entry-content[itemprop=description]").text().trim(),e.status=this.getStatus(l(".tsinfo .imptdt:contains(Statut)").text().replace("Statut","").trim()),r=[],l("ul li:has(div.chbox):has(div.eph-num)").each((function(e,a){var t=l(a).find("a .chapternum").text().trim(),n=l(a).find("a").attr("href"),u=i.parseDate(l(a).find("a .chapterdate").text());n&&n.includes(i.site)&&t&&r.push({name:t,path:n.replace(i.site,""),releaseTime:u})})),e.chapters=r,[2,e]}}))}))},o.prototype.parseDate=function(e){var a=e.split(" "),t=a[0],l=a[1],r=a[2];return(0,u.default)("".concat(l," ").concat({janvier:"January",fevrier:"February",mars:"March",avril:"April",mai:"May",juin:"June",juillet:"July",aout:"August",septembre:"September",octobre:"October",novembre:"November",decembre:"December"}[t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")]," ").concat(r),"D MMMM YYYY").format("YYYY-MM-DD")},o.prototype.getStatus=function(e){var a=e.toLowerCase();return["en cours","en cours de publication"].includes(a)?i.NovelStatus.Ongoing:["en pause","en attente"].includes(a)?i.NovelStatus.OnHiatus:["complété","fini","achevé","terminé"].includes(a)?i.NovelStatus.Completed:["abandonné"].includes(a)?i.NovelStatus.Cancelled:i.NovelStatus.Unknown},o.prototype.parseChapter=function(t){return e(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.getCheerio(this.site+t)];case 1:return[2,e.sent()("#readerarea").html()||""]}}))}))},o.prototype.searchNovels=function(t,l){return e(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return 1!==l?[2,[]]:[4,this.popularNovels(1,{showLatestNovels:!0,filters:void 0})];case 1:return[2,e.sent().filter((function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().includes(t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim())}))]}}))}))},o}();exports.default=new o;